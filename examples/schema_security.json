{
  "name": "security-alerts",
  "species": [
    {
      "name": "Event",
      "description": "Raw security/ops events"
    },
    {
      "name": "Suspicion",
      "description": "Suspicious entities (IP/user/etc.)"
    },
    {
      "name": "Alert",
      "description": "Alerts generated by the system"
    }
  ],
  "reactions": [
    {
      "id": "login_failure_to_suspicion",
      "name": "Promote login failures to suspicion",
      "input": {
        "species": "Event",
        "where": {
          "type": { "eq": "login_failed" }
        }
      },
      "rate": 1.0,
      "effects": [
        { "consume": true },
        {
          "create": {
            "species": "Suspicion",
            "payload": {
              "ip": "$m.ip",
              "kind": "login_failed"
            },
            "energy": 1.0,
            "stability": 1.0
          }
        }
      ]
    },
    {
      "id": "decay_suspicion",
      "name": "Decay Suspicion molecules",
      "input": {
        "species": "Suspicion"
      },
      "rate": 1.0,
      "effects": [
        {
          "update": {
            "energy_add": -0.1
          }
        },
        {
          "if": {
            "field": "energy",
            "op": "lte",
            "value": 0.0
          },
          "then": [{ "consume": true }]
        }
      ]
    }
  ]
}
